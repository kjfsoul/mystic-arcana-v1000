(()=>{var e={};e.id=3809,e.ids=[3809],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},54800:(e,t,a)=>{"use strict";a.r(t),a.d(t,{patchFetch:()=>y,routeModule:()=>d,serverHooks:()=>g,workAsyncStorage:()=>h,workUnitAsyncStorage:()=>m});var r={};a.r(r),a.d(r,{POST:()=>u});var n=a(96559),i=a(48088),o=a(37719),s=a(32190),l=a(79646),c=a(33873),p=a.n(c);async function u(e){try{var t,a;let r=await e.json();if(!r.person1||!r.person2)return s.NextResponse.json({success:!1,error:"Both person1 and person2 data are required"},{status:400});let n={name:r.person1.name,year:new Date(r.person1.date).getFullYear(),month:new Date(r.person1.date).getMonth()+1,day:new Date(r.person1.date).getDate(),hour:new Date(r.person1.date).getHours(),minute:new Date(r.person1.date).getMinutes(),city:r.person1.city,country:r.person1.country||""},i={name:r.person2.name,year:new Date(r.person2.date).getFullYear(),month:new Date(r.person2.date).getMonth()+1,day:new Date(r.person2.date).getDate(),hour:new Date(r.person2.date).getHours(),minute:new Date(r.person2.date).getMinutes(),city:r.person2.city,country:r.person2.country||""},o=await (t="synastry",a={person1:n,person2:i},new Promise(e=>{let r=process.env.PYTHON_PATH||"python3",n=p().join(process.cwd(),"src/services/astrology-python/simple_astrology.py"),i=(0,l.spawn)(r,[n,t,JSON.stringify(a)]),o="",s="";i.stdout.on("data",e=>{o+=e.toString()}),i.stderr.on("data",e=>{s+=e.toString()}),i.on("close",t=>{if(0!==t){console.error("Python script error:",s),e({success:!1,error:`Python script failed with code ${t}: ${s}`});return}try{let t=JSON.parse(o);e(t)}catch(t){console.error("Failed to parse Python output:",o),e({success:!1,error:`Failed to parse Python output: ${t}`})}}),i.on("error",t=>{console.error("Failed to spawn Python process:",t),e({success:!1,error:`Failed to spawn Python process: ${t.message}`})}),setTimeout(()=>{i.kill(),e({success:!1,error:"Python script timeout"})},3e4)}));if(!o.success)return s.NextResponse.json({success:!0,data:{love:{rating:0,description:"Compatibility data temporarily unavailable. Please try again later."},friendship:{rating:0,description:"Compatibility data temporarily unavailable. Please try again later."},teamwork:{rating:0,description:"Compatibility data temporarily unavailable. Please try again later."},overall:{summary:"We're currently unable to access the astronomical calculation service. Please try again in a few moments.",keyAspects:["Service temporarily unavailable"]},isUnavailable:!0}});let c=function(e){var t,a,r;if(!e)return{love:{rating:0,description:"Data unavailable"},friendship:{rating:0,description:"Data unavailable"},teamwork:{rating:0,description:"Data unavailable"},overall:{summary:"Data unavailable",keyAspects:["Service unavailable"]}};let n=e.compatibility_score||75,i=e.synastry_aspects||[],o=n,s=n,l=n,c=i.filter(e=>"trine"===e.aspect||"sextile"===e.aspect||"conjunction"===e.aspect).length,p=5*c-3*i.filter(e=>"square"===e.aspect||"opposition"===e.aspect).length;return o=Math.max(1,Math.min(5,(o+p)/20)),s=Math.max(1,Math.min(5,(s+.8*p)/20)),l=Math.max(1,Math.min(5,(l+.9*p)/20)),{love:{rating:Math.ceil(o),description:(t=o)>=4.5?"Incredible romantic chemistry! Your hearts beat in cosmic harmony, creating a passionate and deeply fulfilling connection.":t>=3.5?"Strong romantic potential with natural attraction and emotional understanding. Your love story has beautiful cosmic support.":t>=2.5?"Good romantic compatibility with some areas of growth. Communication and patience will strengthen your bond over time.":t>=1.5?"Moderate romantic connection that requires effort and understanding. Different approaches to love can create both challenges and growth.":"Romantic compatibility may require significant work and compromise. Focus on building friendship and understanding first."},friendship:{rating:Math.ceil(s),description:(a=s)>=4.5?"Exceptional friendship potential! You understand each other intuitively and bring out the best in one another.":a>=3.5?"Strong friendship compatibility with shared values and mutual respect. You'll create lasting memories together.":a>=2.5?"Good friendship foundation with complementary qualities. Your differences can create interesting and enriching exchanges.":a>=1.5?"Moderate friendship compatibility. Building trust and finding common ground will strengthen your connection over time.":"Friendship may require patience and understanding. Focus on respecting differences and finding shared interests."},teamwork:{rating:Math.ceil(l),description:(r=l)>=4.5?"Outstanding teamwork potential! You complement each other's strengths and work toward goals with unified energy.":r>=3.5?"Strong collaborative compatibility with shared work ethics and complementary skills. Projects together will flourish.":r>=2.5?"Good teamwork potential with some areas to navigate. Clear communication about roles and expectations will help.":r>=1.5?"Moderate teamwork compatibility. Success will come through patience, compromise, and leveraging individual strengths.":"Teamwork may face challenges. Focus on clear communication, defined roles, and respecting different working styles."},overall:{summary:function(e,t,a){let r=(e+t+a)/3;return r>=4.5?"Your cosmic connection is truly exceptional! The stars have aligned to create a harmonious and supportive relationship across all areas of life. This is a rare and precious bond that can weather any storm and celebrate every joy together.":r>=3.5?"You share a wonderful cosmic connection with strong potential for lasting happiness. While every relationship has its seasons, your charts suggest natural harmony and mutual support that will help you grow together.":r>=2.5?"Your relationship has solid cosmic foundations with room for growth and discovery. The challenges you face together will strengthen your bond and help you both evolve as individuals and as a partnership.":r>=1.5?"Your cosmic connection offers opportunities for learning and growth. While it may require more effort and understanding, the rewards of working through differences can lead to a deeply meaningful relationship.":"Your relationship will require patience, communication, and mutual respect to flourish. The cosmos encourages you to approach this connection with open hearts and realistic expectations, focusing on building understanding over time."}(o,s,l),keyAspects:function(e){let t=[];return e.forEach(e=>{"conjunction"===e.aspect?t.push(`${e.planet1}-${e.planet2} conjunction creating powerful unified energy`):"trine"===e.aspect?t.push(`${e.planet1}-${e.planet2} trine bringing natural harmony and flow`):"sextile"===e.aspect?t.push(`${e.planet1}-${e.planet2} sextile offering opportunities for growth and cooperation`):"square"===e.aspect?t.push(`${e.planet1}-${e.planet2} square providing dynamic tension that catalyzes growth`):"opposition"===e.aspect&&t.push(`${e.planet1}-${e.planet2} opposition creating complementary yet challenging dynamics`)}),t.length<3&&(t.push("Unique cosmic patterns creating opportunities for mutual growth and discovery"),t.push("Planetary positions suggesting the importance of patience and open communication"),t.push("Astrological indicators pointing toward building trust through shared experiences")),t.slice(0,5)}(i)}}}(o.data);return s.NextResponse.json({success:!0,data:{...c,rawSynastryData:o.data,timestamp:new Date().toISOString()}})}catch(e){return console.error("Compatibility API error:",e),s.NextResponse.json({success:!0,data:{love:{rating:0,description:"Compatibility data temporarily unavailable. Please try again later."},friendship:{rating:0,description:"Compatibility data temporarily unavailable. Please try again later."},teamwork:{rating:0,description:"Compatibility data temporarily unavailable. Please try again later."},overall:{summary:"We're currently experiencing technical difficulties with our astrological calculation service. Please try again in a few moments.",keyAspects:["Service temporarily unavailable"]},isUnavailable:!0,error:e instanceof Error?e.message:"Unknown error"}})}}let d=new n.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/astrology/compatibility/route",pathname:"/api/astrology/compatibility",filename:"route",bundlePath:"app/api/astrology/compatibility/route"},resolvedPagePath:"/Users/kfitz/mystic-arcana-v1000/src/app/api/astrology/compatibility/route.ts",nextConfigOutput:"",userland:r}),{workAsyncStorage:h,workUnitAsyncStorage:m,serverHooks:g}=d;function y(){return(0,o.patchFetch)({workAsyncStorage:h,workUnitAsyncStorage:m})}},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},79646:e=>{"use strict";e.exports=require("child_process")},96487:()=>{}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[4447,580],()=>a(54800));module.exports=r})();