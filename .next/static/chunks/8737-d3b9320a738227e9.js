(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8737],{334:e=>{e.exports={galaxyContainer:"GalaxyBackground_galaxyContainer__mFeQb",galaxyGradient:"GalaxyBackground_galaxyGradient__RF0on",galaxyPulse:"GalaxyBackground_galaxyPulse__zqda5",galaxyCanvas:"GalaxyBackground_galaxyCanvas__d5RnP",cosmicDust:"GalaxyBackground_cosmicDust__evUVZ",cosmicDrift:"GalaxyBackground_cosmicDrift__04bEb",milkyWay:"GalaxyBackground_milkyWay__XYYJt"}},4493:e=>{e.exports={starFieldContainer:"HighPerformanceStarField_starFieldContainer__YXvcO",galaxyBackground:"HighPerformanceStarField_galaxyBackground__HH3Vp",starCanvas:"HighPerformanceStarField_starCanvas__18fR0",loadingOverlay:"HighPerformanceStarField_loadingOverlay__bHykb",loadingSpinner:"HighPerformanceStarField_loadingSpinner__Hyaof",spin:"HighPerformanceStarField_spin__6e06E",errorOverlay:"HighPerformanceStarField_errorOverlay__Tn7UM",errorMessage:"HighPerformanceStarField_errorMessage__2Sdsn",performanceInfo:"HighPerformanceStarField_performanceInfo__Tzc2H",starCount:"HighPerformanceStarField_starCount__XRyj5",mode:"HighPerformanceStarField_mode__rS8l_",performanceStats:"HighPerformanceStarField_performanceStats__cIK7h",statLine:"HighPerformanceStarField_statLine__3FSnx",statLabel:"HighPerformanceStarField_statLabel__H0Z8g",statValue:"HighPerformanceStarField_statValue__KekFT"}},8737:(e,t,a)=>{"use strict";a.d(t,{r:()=>S});var r=a(5155),i=a(2115);class n{initializeWebGL(){let{gl:e}=this;"drawArraysInstanced"in e?console.info("\uD83D\uDE80 High-performance instanced rendering enabled"):console.info("\uD83C\uDFAE Using standard rendering (WebGL2 instanced rendering available)"),e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.clearColor(0,0,.05,1),this.createShaderPrograms(),this.setupBuffers()}createShaderPrograms(){let e=this.compileShader("#version 300 es\n      precision highp float;\n      \n      in vec3 a_position;\n      in float a_magnitude;\n      in float a_colorIndex;\n      in float a_twinklePhase;\n      \n      uniform mat4 u_viewMatrix;\n      uniform mat4 u_projectionMatrix;\n      uniform float u_time;\n      uniform float u_pixelRatio;\n      uniform vec2 u_resolution;\n      \n      out float v_magnitude;\n      out float v_colorIndex;\n      out float v_alpha;\n      out float v_size;\n      \n      void main() {\n        vec4 worldPos = vec4(a_position, 1.0);\n        vec4 viewPos = u_viewMatrix * worldPos;\n        gl_Position = u_projectionMatrix * viewPos;\n        \n        // Calculate star size based on magnitude and distance\n        float baseMagnitude = 6.0 - a_magnitude; // Invert magnitude (brighter = larger)\n        float distance = length(viewPos.xyz);\n        float size = max(1.0, baseMagnitude * 2.0 / distance) * u_pixelRatio;\n        \n        // Add atmospheric twinkling\n        float twinkle = 0.8 + 0.2 * sin(u_time * 0.003 + a_twinklePhase);\n        size *= twinkle;\n        \n        // Limit maximum size for performance\n        gl_PointSize = min(size, 20.0);\n        \n        // Calculate alpha based on magnitude and atmospheric effects\n        float atmosphericDimming = 1.0 - smoothstep(0.0, 100.0, distance);\n        v_alpha = max(0.1, (1.0 - (a_magnitude - 1.0) / 5.0)) * twinkle * atmosphericDimming;\n        v_magnitude = a_magnitude;\n        v_colorIndex = a_colorIndex;\n        v_size = size;\n      }\n    ",this.gl.VERTEX_SHADER),t=this.compileShader("#version 300 es\n      precision highp float;\n      \n      in float v_magnitude;\n      in float v_colorIndex;\n      in float v_alpha;\n      in float v_size;\n      \n      out vec4 fragColor;\n      \n      // Convert B-V color index to RGB\n      vec3 colorFromBV(float bv) {\n        if (bv < -0.3) return vec3(0.6, 0.7, 1.0);      // Blue\n        if (bv < 0.0) return vec3(0.7, 0.75, 1.0);      // Blue-white\n        if (bv < 0.3) return vec3(0.8, 0.85, 1.0);      // White\n        if (bv < 0.6) return vec3(1.0, 0.97, 0.9);      // Yellow-white\n        if (bv < 1.0) return vec3(1.0, 0.9, 0.7);       // Yellow\n        if (bv < 1.4) return vec3(1.0, 0.8, 0.6);       // Orange\n        return vec3(1.0, 0.7, 0.4);                     // Red\n      }\n      \n      void main() {\n        // Create circular star shape with soft edges\n        vec2 coord = gl_PointCoord - vec2(0.5);\n        float dist = length(coord);\n        \n        if (dist > 0.5) {\n          discard;\n        }\n        \n        // Create star glow effect\n        float glow = 1.0 - smoothstep(0.0, 0.5, dist);\n        glow = pow(glow, 1.5);\n        \n        // Add diffraction spikes for bright stars\n        float spikes = 1.0;\n        if (v_magnitude < 3.0 && v_size > 5.0) {\n          float angle = atan(coord.y, coord.x);\n          float spike1 = abs(sin(angle * 2.0));\n          float spike2 = abs(cos(angle * 2.0));\n          spikes = 1.0 + 0.4 * max(spike1, spike2) * (1.0 - dist * 2.0);\n        }\n        \n        vec3 color = colorFromBV(v_colorIndex);\n        float alpha = v_alpha * glow * spikes;\n        \n        // Add subtle chromatic aberration for realism\n        if (v_magnitude < 2.0) {\n          color.r *= 1.0 + 0.1 * (1.0 - dist);\n          color.b *= 1.0 + 0.05 * dist;\n        }\n        \n        fragColor = vec4(color, alpha);\n      }\n    ",this.gl.FRAGMENT_SHADER);if(this.program=this.gl.createProgram(),!this.program)throw Error("Failed to create shader program");if(this.gl.attachShader(this.program,e),this.gl.attachShader(this.program,t),this.gl.linkProgram(this.program),!this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS)){let e=this.gl.getProgramInfoLog(this.program);throw Error("Shader program linking failed: ".concat(e))}this.uniforms.viewMatrix=this.gl.getUniformLocation(this.program,"u_viewMatrix"),this.uniforms.projectionMatrix=this.gl.getUniformLocation(this.program,"u_projectionMatrix"),this.uniforms.time=this.gl.getUniformLocation(this.program,"u_time"),this.uniforms.pixelRatio=this.gl.getUniformLocation(this.program,"u_pixelRatio"),this.uniforms.resolution=this.gl.getUniformLocation(this.program,"u_resolution"),this.attributes.position=this.gl.getAttribLocation(this.program,"a_position"),this.attributes.magnitude=this.gl.getAttribLocation(this.program,"a_magnitude"),this.attributes.colorIndex=this.gl.getAttribLocation(this.program,"a_colorIndex"),this.attributes.twinklePhase=this.gl.getAttribLocation(this.program,"a_twinklePhase"),console.log("\uD83D\uDD17 Attribute locations:",{position:this.attributes.position,magnitude:this.attributes.magnitude,colorIndex:this.attributes.colorIndex,twinklePhase:this.attributes.twinklePhase})}compileShader(e,t){let{gl:a}=this,r=t===a.VERTEX_SHADER?"vertex":"fragment";console.log("\uD83D\uDD27 Compiling ".concat(r," shader..."));let i=a.createShader(t);if(!i)throw Error("Failed to create shader");if(a.shaderSource(i,e),a.compileShader(i),!a.getShaderParameter(i,a.COMPILE_STATUS)){let t=a.getShaderInfoLog(i);throw console.error("❌ ".concat(r," shader compilation failed:"),t),console.error("Shader source:",e),a.deleteShader(i),Error("Shader compilation failed: ".concat(t))}return console.log("✅ ".concat(r," shader compiled successfully")),i}setupBuffers(){let{gl:e}=this;if(this.positionBuffer=e.createBuffer(),this.magnitudeBuffer=e.createBuffer(),this.colorBuffer=e.createBuffer(),this.twinkleBuffer=e.createBuffer(),!this.positionBuffer||!this.magnitudeBuffer||!this.colorBuffer||!this.twinkleBuffer)throw Error("Failed to create vertex buffers")}loadStars(e){this.stars=e,this.prepareRenderData(),this.uploadToGPU(),this.stats.totalStars=e.length,console.log("\uD83C\uDF1F Loaded ".concat(e.length," stars for high-performance rendering"))}prepareRenderData(){let e=this.stars.length;console.log("\uD83D\uDD04 Preparing render data for ".concat(e," stars...")),this.renderData={position:new Float32Array(3*e),magnitude:new Float32Array(e),colorIndex:new Float32Array(e),twinklePhase:new Float32Array(e),visible:new Uint8Array(e)},console.log("\uD83D\uDCCA Allocated arrays: positions(".concat(this.renderData.position.length,"), magnitudes(").concat(this.renderData.magnitude.length,"), colors(").concat(this.renderData.colorIndex.length,"), twinkle(").concat(this.renderData.twinklePhase.length,")"));for(let r=0;r<e;r++){var t,a;let e=this.stars[r],i=3*r,n=(null!=(t=e.ra)?t:0)*Math.PI/180,o=(null!=(a=e.dec)?a:0)*Math.PI/180;this.renderData.position[i]=Math.cos(o)*Math.cos(n),this.renderData.position[i+1]=Math.cos(o)*Math.sin(n),this.renderData.position[i+2]=Math.sin(o),this.renderData.magnitude[r]=e.magnitude,this.renderData.colorIndex[r]=e.colorIndex||0,this.renderData.twinklePhase[r]=Math.random()*Math.PI*2,this.renderData.visible[r]=1}}uploadToGPU(){if(!this.renderData)return;let{gl:e}=this;e.bindBuffer(e.ARRAY_BUFFER,this.positionBuffer),e.bufferData(e.ARRAY_BUFFER,this.renderData.position,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.magnitudeBuffer),e.bufferData(e.ARRAY_BUFFER,this.renderData.magnitude,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.colorBuffer),e.bufferData(e.ARRAY_BUFFER,this.renderData.colorIndex,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.twinkleBuffer),e.bufferData(e.ARRAY_BUFFER,this.renderData.twinklePhase,e.STATIC_DRAW)}render(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),t=performance.now();if(!this.program||!this.renderData)return this.stats;let{gl:a}=this;a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),a.useProgram(this.program),this.setupVertexAttributes(),a.uniformMatrix4fv(this.uniforms.viewMatrix,!1,this.viewMatrix),a.uniformMatrix4fv(this.uniforms.projectionMatrix,!1,this.projectionMatrix),a.uniform1f(this.uniforms.time,e),a.uniform1f(this.uniforms.pixelRatio,window.devicePixelRatio||1),a.uniform2f(this.uniforms.resolution,this.canvas.width,this.canvas.height);let r=this.performFrustumCulling();this.frameCount%60==0&&console.log("\uD83C\uDFA8 Drawing ".concat(r," stars... (frame ").concat(this.frameCount,")")),a.drawArrays(a.POINTS,0,r);let i=a.getError();i!==a.NO_ERROR&&console.error("❌ WebGL error during draw:",i);let n=performance.now()-t;return this.updateStats(n,r),this.stats}setupVertexAttributes(){let{gl:e}=this;null!==this.attributes.position&&this.attributes.position>=0&&(e.bindBuffer(e.ARRAY_BUFFER,this.positionBuffer),e.enableVertexAttribArray(this.attributes.position),e.vertexAttribPointer(this.attributes.position,3,e.FLOAT,!1,0,0)),null!==this.attributes.magnitude&&this.attributes.magnitude>=0&&(e.bindBuffer(e.ARRAY_BUFFER,this.magnitudeBuffer),e.enableVertexAttribArray(this.attributes.magnitude),e.vertexAttribPointer(this.attributes.magnitude,1,e.FLOAT,!1,0,0)),null!==this.attributes.colorIndex&&this.attributes.colorIndex>=0&&(e.bindBuffer(e.ARRAY_BUFFER,this.colorBuffer),e.enableVertexAttribArray(this.attributes.colorIndex),e.vertexAttribPointer(this.attributes.colorIndex,1,e.FLOAT,!1,0,0)),null!==this.attributes.twinklePhase&&this.attributes.twinklePhase>=0&&(e.bindBuffer(e.ARRAY_BUFFER,this.twinkleBuffer),e.enableVertexAttribArray(this.attributes.twinklePhase),e.vertexAttribPointer(this.attributes.twinklePhase,1,e.FLOAT,!1,0,0))}performFrustumCulling(){return this.stats.totalStars}updateStats(e,t){this.stats.renderTime=e,this.stats.visibleStars=t,this.stats.culledStars=this.stats.totalStars-t,this.frameCount++;let a=performance.now();a-this.fpsUpdateTime>1e3&&(this.stats.fps=this.frameCount/((a-this.fpsUpdateTime)/1e3),this.frameCount=0,this.fpsUpdateTime=a)}updateMatrices(e,t){this.viewMatrix.set(e),this.projectionMatrix.set(t)}resize(e,t){let a=window.devicePixelRatio||1;this.canvas.width=e*a,this.canvas.height=t*a,this.canvas.style.width="".concat(e,"px"),this.canvas.style.height="".concat(t,"px"),this.gl.viewport(0,0,this.canvas.width,this.canvas.height)}getStats(){return{...this.stats}}dispose(){let{gl:e}=this;this.program&&e.deleteProgram(this.program),this.positionBuffer&&e.deleteBuffer(this.positionBuffer),this.magnitudeBuffer&&e.deleteBuffer(this.magnitudeBuffer),this.colorBuffer&&e.deleteBuffer(this.colorBuffer),this.twinkleBuffer&&e.deleteBuffer(this.twinkleBuffer)}constructor(e){this.program=null,this.instancedProgram=null,this.positionBuffer=null,this.magnitudeBuffer=null,this.colorBuffer=null,this.twinkleBuffer=null,this.instancePositionBuffer=null,this.instanceDataBuffer=null,this.uniforms={},this.attributes={},this.stars=[],this.renderData=null,this.viewMatrix=new Float32Array(16),this.projectionMatrix=new Float32Array(16),this.frustumPlanes=new Float32Array(24),this.stats={totalStars:0,visibleStars:0,culledStars:0,renderTime:0,fps:0},this.frameCount=0,this.lastFrameTime=0,this.fpsUpdateTime=0,this.canvas=e,console.log("\uD83C\uDFAE Initializing HighPerformanceStarRenderer..."),console.log("\uD83D\uDCD0 Canvas dimensions: ".concat(e.width,"x").concat(e.height)),console.log("\uD83D\uDCCF Canvas style: ".concat(e.style.width,"x").concat(e.style.height));let t=e.getContext("webgl2",{alpha:!1,depth:!0,stencil:!1,antialias:!1,powerPreference:"high-performance"});if(!t)throw Error("WebGL2 not supported");console.log("✅ WebGL2 context created"),this.gl=t,this.initializeWebGL()}}var o=function(e){return e.SUN="Sun",e.MOON="Moon",e.MERCURY="Mercury",e.VENUS="Venus",e.MARS="Mars",e.JUPITER="Jupiter",e.SATURN="Saturn",e.URANUS="Uranus",e.NEPTUNE="Neptune",e.PLUTO="Pluto",e.CHIRON="Chiron",e.NORTH_NODE="North Node",e.SOUTH_NODE="South Node",e}({}),s=function(e){return e.ARIES="Aries",e.TAURUS="Taurus",e.GEMINI="Gemini",e.CANCER="Cancer",e.LEO="Leo",e.VIRGO="Virgo",e.LIBRA="Libra",e.SCORPIO="Scorpio",e.SAGITTARIUS="Sagittarius",e.CAPRICORN="Capricorn",e.AQUARIUS="Aquarius",e.PISCES="Pisces",e}({}),l=function(e){return e.CONJUNCTION="Conjunction",e.OPPOSITION="Opposition",e.TRINE="Trine",e.SQUARE="Square",e.SEXTILE="Sextile",e.QUINCUNX="Quincunx",e.SEMISEXTILE="Semisextile",e.SEMISQUARE="Semisquare",e.SESQUIQUADRATE="Sesquiquadrate",e}({});class c{async initialize(){try{if(this.config.useMockData)return console.log("Swiss Ephemeris bridge initialized with mock data"),this.isInitialized=!0,!0;let e=await this.validateInstallation();return e.success||(console.warn("Swiss Ephemeris API validation failed: ".concat(e.error,", falling back to mock data")),this.config.useMockData=!0),this.isInitialized=!0,console.log("Swiss Ephemeris bridge initialized successfully"),!0}catch(e){return console.error("Failed to initialize Swiss Ephemeris bridge:",e),this.config.useMockData=!0,this.isInitialized=!0,!0}}async calculatePlanetaryPositions(e){if(!this.isInitialized)throw Error("Swiss Ephemeris bridge not initialized");let t=this.generateCacheKey("planets",e),a=this.getFromCache(t);if(a)return a;try{var r,i,n,o;if(this.config.useMockData){let a=this.generateMockPlanetaryData(e);return this.setCache(t,a),a}let a=["planetary_positions.py","--datetime",e.datetime.toISOString(),"--latitude",e.location.latitude.toString(),"--longitude",e.location.longitude.toString(),"--planets",e.planets.join(","),"--precision",this.config.precision];(null==(r=e.options)?void 0:r.includeRetrograde)&&a.push("--include-retrograde"),(null==(i=e.options)?void 0:i.calculateAspects)&&a.push("--calculate-aspects"),(null==(n=e.options)?void 0:n.includeHouses)&&a.push("--include-houses"),(null==(o=e.options)?void 0:o.heliocentric)&&a.push("--heliocentric");let s=await this.executePythonScript(a);if(!s.success||!s.data)throw Error("Planetary calculation failed: ".concat(s.error));let l=this.parsePlanetaryData(s.data);return this.setCache(t,l),l}catch(e){throw console.error("Planetary position calculation error:",e),e}}async calculateAspects(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8;if(!this.isInitialized)throw Error("Swiss Ephemeris bridge not initialized");let r=this.generateCacheKey("aspects",{planets:e,datetime:t,orbTolerance:a}),i=this.getFromCache(r);if(i)return i;try{if(this.config.useMockData){let i=this.generateMockAspectData(e,t,a);return this.setCache(r,i),i}let i=["aspect_calculator.py","--datetime",t.toISOString(),"--planets",e.join(","),"--orb-tolerance",a.toString(),"--precision",this.config.precision],n=await this.executePythonScript(i);if(!n.success||!n.data)throw Error("Aspect calculation failed: ".concat(n.error));let o=this.parseAspectData(n.data);return this.setCache(r,o),o}catch(e){throw console.error("Aspect calculation error:",e),e}}async detectRetrogrades(e,t,a){if(!this.isInitialized)throw Error("Swiss Ephemeris bridge not initialized");let r=this.generateCacheKey("retrogrades",{planet:e,startDate:t,endDate:a}),i=this.getFromCache(r);if(i)return i;try{if(this.config.useMockData){let i=this.generateMockRetrogradeData(e,t,a);return this.setCache(r,i),i}let i=["retrograde_detector.py","--planet",e,"--start-date",t.toISOString(),"--end-date",a.toISOString(),"--precision",this.config.precision],n=await this.executePythonScript(i);if(!n.success||!n.data)throw Error("Retrograde detection failed: ".concat(n.error));let o=this.parseRetrogradeData(n.data);return this.setCache(r,o),o}catch(e){throw console.error("Retrograde detection error:",e),e}}async calculateCosmicWeather(e,t){if(!this.isInitialized)throw Error("Swiss Ephemeris bridge not initialized");let a=this.generateCacheKey("cosmic_weather",{datetime:e,location:t}),r=this.getFromCache(a);if(r)return r;try{if(this.config.useMockData){let t=this.generateMockCosmicWeather(e);return this.setCache(a,t),t}let r=["cosmic_weather.py","--datetime",e.toISOString(),"--latitude",t.latitude.toString(),"--longitude",t.longitude.toString(),"--precision",this.config.precision],i=await this.executePythonScript(r);if(!i.success||!i.data)throw Error("Cosmic weather calculation failed: ".concat(i.error));let n=this.parseCosmicWeatherData(i.data);return this.setCache(a,n),n}catch(e){throw console.error("Cosmic weather calculation error:",e),e}}async calculateMoonPhase(e){if(!this.isInitialized)throw Error("Swiss Ephemeris bridge not initialized");let t=this.generateCacheKey("moon_phase",{datetime:e}),a=this.getFromCache(t);if(a)return a;try{if(this.config.useMockData){let a=this.generateMockMoonData(e);return this.setCache(t,a),a}let a=["moon_calculator.py","--datetime",e.toISOString(),"--precision",this.config.precision],r=await this.executePythonScript(a);if(!r.success||!r.data)throw Error("Moon phase calculation failed: ".concat(r.error));let i=this.parseMoonData(r.data);return this.setCache(t,i),i}catch(e){throw console.error("Moon phase calculation error:",e),e}}async validateInstallation(){try{let e=await fetch("".concat(this.config.apiEndpoint,"/status"),{method:"GET",signal:AbortSignal.timeout(this.config.timeout)});return{success:e.ok,data:await e.text(),error:e.ok?void 0:"API validation failed: ".concat(e.status)}}catch(e){return{success:!1,error:e instanceof Error?e.message:String(e)}}}async executePythonScript(e){let t=Date.now();try{let a=await fetch("".concat(this.config.apiEndpoint,"/").concat(e[0].replace(".py","")),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({args:e.slice(1)}),signal:AbortSignal.timeout(this.config.timeout)}),r=Date.now()-t;if(!a.ok)throw Error("API request failed: ".concat(a.status));return{success:!0,data:await a.json(),calculationTime:r,precision:this.config.precision}}catch(e){return{success:!1,error:e instanceof Error?e.message:String(e),calculationTime:Date.now()-t}}}generateMockPlanetaryData(e){let t=Date.now(),a=Math.floor((t-new Date(new Date().getFullYear(),0,0).getTime())/864e5);return e.planets.map((e,r)=>{let i=(a+30*r)%360,n=(i+10*Math.sin(t/1e6))%360,o=23.5*Math.sin((i+45*r)*Math.PI/180),s=this.getZodiacSign(i);return{planet:this.getPlanetEnum(e),name:e,symbol:this.getPlanetSymbol(e),coordinates:{ra:n,dec:o},position:{ra:n,dec:o},eclipticLongitude:i,eclipticLatitude:5*Math.sin(t/2e6+r),distance:1+.5*Math.sin(t/5e6+r),magnitude:r<5?-2+.5*r:2+3*Math.random(),phase:"moon"===e.toLowerCase()?(Math.sin(t/25e5)+1)/2:1,angularDiameter:30/(1+r),angularSize:30/(1+r),speed:1-.1*r,retrograde:-.8>Math.sin(t/1e7+r),sign:this.getZodiacSignEnum(s),zodiacSign:s,degree:i%30,zodiacDegree:i%30,house:Math.floor(i/30)%12+1}})}getPlanetSymbol(e){return({sun:"☉",moon:"☽",mercury:"☿",venus:"♀",mars:"♂",jupiter:"♃",saturn:"♄",uranus:"♅",neptune:"♆",pluto:"♇"})[e]||"○"}getZodiacSign(e){return["Aries","Taurus","Gemini","Cancer","Leo","Virgo","Libra","Scorpio","Sagittarius","Capricorn","Aquarius","Pisces"][Math.floor(e/30)%12]}getZodiacSignEnum(e){return({Aries:s.ARIES,Taurus:s.TAURUS,Gemini:s.GEMINI,Cancer:s.CANCER,Leo:s.LEO,Virgo:s.VIRGO,Libra:s.LIBRA,Scorpio:s.SCORPIO,Sagittarius:s.SAGITTARIUS,Capricorn:s.CAPRICORN,Aquarius:s.AQUARIUS,Pisces:s.PISCES})[e]||s.ARIES}getPlanetEnum(e){return({sun:o.SUN,moon:o.MOON,mercury:o.MERCURY,venus:o.VENUS,mars:o.MARS,jupiter:o.JUPITER,saturn:o.SATURN,uranus:o.URANUS,neptune:o.NEPTUNE,pluto:o.PLUTO,chiron:o.CHIRON,"north node":o.NORTH_NODE,"south node":o.SOUTH_NODE})[e.toLowerCase()]||o.SUN}generateMockAspectData(e,t,a){let r=[],i=[l.CONJUNCTION,l.SEXTILE,l.SQUARE,l.TRINE,l.OPPOSITION];for(let t=0;t<e.length;t++)for(let n=t+1;n<e.length;n++)if(.3>Math.random()){let o=i[Math.floor(Math.random()*i.length)],s=.5>Math.random();r.push({planet1:this.getPlanetEnum(e[t]),planet2:this.getPlanetEnum(e[n]),aspect:o,type:o,angle:this.getAspectAngle(o)+(Math.random()-.5)*a,orb:Math.random()*a,exact:.1>Math.random(),applying:s,separating:!s,influence:this.getAspectInfluence(o),strength:Math.random()})}return r}getAspectAngle(e){return({[l.CONJUNCTION]:0,[l.SEXTILE]:60,[l.SQUARE]:90,[l.TRINE]:120,[l.OPPOSITION]:180,[l.SEMISEXTILE]:30,[l.QUINCUNX]:150,[l.SEMISQUARE]:45,[l.SESQUIQUADRATE]:135})[e]||0}getAspectInfluence(e){let t=[l.CONJUNCTION,l.SEXTILE,l.TRINE],a=[l.SQUARE,l.OPPOSITION];return t.includes(e)?"harmonious":a.includes(e)?"challenging":"neutral"}generateMockRetrogradeData(e,t,a){let r=[],i=Math.floor(3*Math.random())+1;for(let n=0;n<i;n++){let i=new Date(t.getTime()+Math.random()*(a.getTime()-t.getTime())),n=30+60*Math.random(),o=new Date(i.getTime()+24*n*36e5),s=new Date((i.getTime()+o.getTime())/2);r.push({planet:this.getPlanetEnum(e),startDate:i,endDate:o,peakDate:s,shadow:{pre:new Date(i.getTime()-12096e5),post:new Date(o.getTime()+12096e5)},zodiacRange:{start:{sign:"Gemini",degree:15},end:{sign:"Gemini",degree:5}}})}return r}generateMockCosmicWeather(e){let t={phase:"Waxing Gibbous",illumination:.75,age:10,zodiacSign:"Cancer",distance:384400,angularSize:31,libration:{longitude:0,latitude:0},nextPhase:{type:"Full Moon",date:new Date(e.getTime()+2592e5)}};return{timestamp:e,moonPhase:t,planetaryHours:{current:{planet:"Venus",startTime:e,endTime:new Date(e.getTime()+36e5)},next:{planet:"Mercury",startTime:new Date(e.getTime()+36e5)},ruler:"Sun",dayNight:18>e.getHours()?"day":"night"},aspects:{major:[],minor:[],applying:[]},retrogrades:[],cosmicIntensity:"active",spiritualInfluences:[],optimalActivities:[]}}generateMockMoonData(e){return{phase:"waxing-gibbous",illumination:.75,age:10,distance:384400,angularSize:31,nextNewMoon:new Date(e.getTime()+15552e5),nextFullMoon:new Date(e.getTime()+2592e5)}}generateCacheKey(e,t){return"".concat(e,"_").concat(JSON.stringify(t),"_").concat(this.config.precision)}getFromCache(e){let t=this.calculationCache.get(e);return t&&Date.now()-t.timestamp<this.CACHE_TTL?t.data:(this.calculationCache.delete(e),null)}setCache(e,t){this.calculationCache.set(e,{data:t,timestamp:Date.now()})}parsePlanetaryData(e){return e.planets.map(e=>{let t=e.zodiac_sign;return{planet:this.getPlanetEnum(e.name),name:e.name,symbol:e.symbol,coordinates:{ra:e.ra,dec:e.dec},position:{ra:e.ra,dec:e.dec},eclipticLongitude:e.longitude,eclipticLatitude:e.latitude,distance:e.distance,magnitude:e.magnitude,phase:e.phase||1,angularDiameter:e.angular_size,angularSize:e.angular_size,speed:e.speed,retrograde:e.retrograde,sign:this.getZodiacSignEnum(t),zodiacSign:t,degree:e.zodiac_degree,zodiacDegree:e.zodiac_degree,house:e.house}})}parseAspectData(e){return e.aspects.map(e=>{let t=this.parseAspectType(e.type);return{planet1:this.getPlanetEnum(e.planet1),planet2:this.getPlanetEnum(e.planet2),aspect:t,type:t,angle:e.angle,orb:e.orb,exact:e.exact,applying:e.applying,separating:!e.applying,influence:e.influence,strength:e.strength}})}parseAspectType(e){return({conjunction:l.CONJUNCTION,sextile:l.SEXTILE,square:l.SQUARE,trine:l.TRINE,opposition:l.OPPOSITION,semisextile:l.SEMISEXTILE,quincunx:l.QUINCUNX,semisquare:l.SEMISQUARE,sesquiquadrate:l.SESQUIQUADRATE})[e.toLowerCase()]||l.CONJUNCTION}parseRetrogradeData(e){return e.retrogrades.map(e=>{let t=e.shadow,a=e.zodiac_range;return{planet:e.planet,startDate:new Date(e.start_date),endDate:new Date(e.end_date),peakDate:new Date(e.peak_date),shadow:{pre:new Date(t.pre),post:new Date(t.post)},zodiacRange:{start:a.start,end:a.end}}})}parseCosmicWeatherData(e){let t=e.aspects;return{timestamp:new Date(e.timestamp),moonPhase:e.moon_phase,planetaryHours:e.planetary_hours,aspects:{major:t.major,minor:t.minor,applying:t.applying},retrogrades:e.retrogrades,cosmicIntensity:e.cosmic_intensity,spiritualInfluences:e.spiritual_influences,optimalActivities:e.optimal_activities,warnings:e.warnings}}parseMoonData(e){return{phase:e.phase,illumination:e.illumination,age:e.age,distance:e.distance,angularSize:e.angular_size,nextNewMoon:new Date(e.next_new_moon),nextFullMoon:new Date(e.next_full_moon)}}clearCache(){this.calculationCache.clear()}getStatistics(){return{cacheSize:this.calculationCache.size,isInitialized:this.isInitialized,config:this.config}}async getObliquity(e){return console.log("Calculating mock obliquity for ".concat(e)),Promise.resolve(23.439281)}constructor(e={}){var t;this.isInitialized=!1,this.calculationCache=new Map,this.CACHE_TTL=6e4,this.config={apiEndpoint:e.apiEndpoint||"/api/ephemeris",timeout:e.timeout||3e4,precision:e.precision||"high",useMockData:null==(t=e.useMockData)||t}}}new c;class u{async loadCatalog(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a="".concat(e,"_").concat(JSON.stringify(t));if(this.catalogCache.has(a))return this.catalogCache.get(a);if(this.loadingPromises.has(a))return this.loadingPromises.get(a);let r=this.loadCatalogData(e,t);this.loadingPromises.set(a,r);try{let e=await r;return this.catalogCache.set(a,e),this.loadingPromises.delete(a),e}catch(e){throw this.loadingPromises.delete(a),e}}async loadConstellationLines(){try{let e=await fetch(u.CATALOG_URLS.constellations);return await e.json()}catch(e){return console.error("Failed to load constellation lines:",e),{}}}async getNavigationStars(){let e=["Alpheratz","Ankaa","Schedar","Diphda","Achernar","Hamal","Acamar","Menkar","Mirfak","Aldebaran","Rigel","Capella","Bellatrix","Elnath","Alnilam","Betelgeuse","Canopus","Sirius","Adhara","Procyon","Pollux","Avior","Suhail","Miaplacidus","Alphard","Regulus","Dubhe","Denebola","Gienah","Acrux","Gacrux","Alioth","Spica","Alkaid","Hadar","Menkent","Arcturus","Rigil Kentaurus","Zubenelgenubi","Kochab","Alphecca","Antares","Atria","Sabik","Shaula","Rasalhague","Eltanin","Kaus Australis","Vega","Nunki","Altair","Peacock","Deneb","Enif","Alnair","Fomalhaut","Markab"];return(await this.loadCatalog("hipparcos",{maxMagnitude:3})).filter(t=>t.name&&e.includes(t.name))}async loadCatalogData(e,t){if("hipparcos"===e)return this.generateHipparcosCatalog(t);if("yale"===e)return this.generateYaleBrightStars(t);if("messier"===e)return this.loadMessierObjects();throw Error("Unknown catalog type: ".concat(e))}generateHipparcosCatalog(e){var t;let a=[],r=null!=(t=e.maxMagnitude)?t:6.5,i=this.getRealBrightStars();a.push(...i.filter(e=>e.magnitude<=r));let n=Math.min(1e5,Math.floor(10**(r/2.5)));for(let t=0;t<n;t++){let i=this.generateRealisticStar(t,r);this.passesFilters(i,e)&&a.push(i)}return a}getRealBrightStars(){return[{id:"HIP32349",name:"Sirius",ra:101.287155,dec:-16.716116,magnitude:-1.46,spectralType:"A1V",distance:8.6,properMotion:{ra:-546.01,dec:-1223.07},constellation:"CMa",colorIndex:0},{id:"HIP30438",name:"Canopus",ra:95.987958,dec:-52.695661,magnitude:-.74,spectralType:"A9II",distance:310,properMotion:{ra:19.93,dec:23.24},constellation:"Car",colorIndex:.15},{id:"HIP69673",name:"Arcturus",ra:213.9153,dec:19.182409,magnitude:-.05,spectralType:"K1.5III",distance:36.7,properMotion:{ra:-1093.45,dec:-1999.4},constellation:"Boo",colorIndex:1.23},{id:"HIP91262",name:"Vega",ra:279.234735,dec:38.783689,magnitude:.03,spectralType:"A0V",distance:25,properMotion:{ra:200.94,dec:286.23},constellation:"Lyr",colorIndex:0},{id:"HIP24608",name:"Rigel",ra:78.634467,dec:-8.201638,magnitude:.13,spectralType:"B8I",distance:860,properMotion:{ra:1.87,dec:-.56},constellation:"Ori",colorIndex:-.03},{id:"HIP37279",name:"Procyon",ra:114.825493,dec:5.224993,magnitude:.37,spectralType:"F5IV",distance:11.5,properMotion:{ra:-714.59,dec:-1036.8},constellation:"CMi",colorIndex:.42},{id:"HIP27989",name:"Betelgeuse",ra:88.792939,dec:7.407064,magnitude:.5,spectralType:"M1I",distance:548,properMotion:{ra:27.33,dec:10.86},constellation:"Ori",colorIndex:1.85,variableType:"SRc"},{id:"HIP21421",name:"Aldebaran",ra:68.980163,dec:16.509302,magnitude:.85,spectralType:"K5III",distance:65.3,properMotion:{ra:62.78,dec:-189.35},constellation:"Tau",colorIndex:1.54},{id:"HIP65474",name:"Spica",ra:201.298247,dec:-11.16132,magnitude:.97,spectralType:"B1III",distance:250,properMotion:{ra:-42.5,dec:-31.73},constellation:"Vir",colorIndex:-.24,variableType:"ELL"},{id:"HIP80763",name:"Antares",ra:247.351915,dec:-26.432003,magnitude:1.09,spectralType:"M1.5I",distance:600,properMotion:{ra:-12.11,dec:-23.3},constellation:"Sco",colorIndex:1.83,variableType:"LC"}].map(e=>({id:e.id,name:e.name,coordinates:{ra:e.ra,dec:e.dec},ra:e.ra,dec:e.dec,magnitude:e.magnitude,colorIndex:e.colorIndex,spectralClass:e.spectralType,spectralType:e.spectralType,properMotion:e.properMotion||{ra:0,dec:0},parallax:e.distance?1e3/e.distance:void 0,distance:e.distance,constellation:e.constellation,variableType:e.variableType}))}generateRealisticStar(e,t){let a=30*this.gaussianRandom(),r=360*Math.random(),i=this.galacticToEquatorial(r,a),n=this.generateMagnitude(t),o=this.generateSpectralType(n),s=this.estimateDistance(n,o),l=this.getConstellation(i.ra,i.dec),c=this.getColorIndex(o);return{id:"SYN".concat(e),name:void 0,coordinates:i,ra:i.ra,dec:i.dec,magnitude:n,colorIndex:c,spectralClass:o,spectralType:o,properMotion:{ra:0,dec:0},distance:s,constellation:l}}galacticToEquatorial(e,t){let a=e*Math.PI/180,r=t*Math.PI/180,i=27.12825*Math.PI/180,n=122.93192*Math.PI/180,o=Math.asin(Math.sin(r)*Math.sin(i)+Math.cos(r)*Math.cos(i)*Math.sin(a-n)),s=Math.atan2(Math.cos(r)*Math.cos(a-n),Math.sin(r)*Math.cos(i)-Math.cos(r)*Math.sin(i)*Math.sin(a-n))+192.85948*Math.PI/180;return s<0&&(s+=2*Math.PI),{ra:180*s/Math.PI,dec:180*o/Math.PI}}generateMagnitude(e){return -2.5*Math.log10(1-Math.random()*(1-Math.pow(10,-.4*e)))}generateSpectralType(e){let t,a=Math.random();t=e<2?a<.05?"O":a<.15?"B":a<.3?"A":a<.45?"F":a<.6?"G":a<.8?"K":"M":a<.001?"O":a<.01?"B":a<.05?"A":a<.15?"F":a<.3?"G":a<.6?"K":"M";let r=Math.floor(10*Math.random()),i=e<3?["I","II","III","IV","V"][Math.floor(5*Math.random())]:"V";return"".concat(t).concat(r).concat(i)}estimateDistance(e,t){return 3.26156*Math.pow(10,(e-(({O:-5.7,B:-1.1,A:1.4,F:3,G:4.6,K:5.9,M:9})[t[0]]||5)+5)/5)}getColorIndex(e){return({O:-.33,B:-.17,A:0,F:.38,G:.63,K:1,M:1.4})[e[0]]||.63}getConstellation(e,t){if(t>55)return"UMa";if(t<-55)return"Cru";let a=e/15;return a<3?"Psc":a<6?"Ori":a<9?"Leo":a<12?"Vir":a<15?"Sco":a<18?"Sgr":a<21?"Cyg":"And"}generateYaleBrightStars(e){return this.generateHipparcosCatalog({...e,maxMagnitude:6.5})}async loadMessierObjects(){return[{id:"M1",name:"Crab Nebula",ra:83.633,dec:22.014,magnitude:8.4,type:"SNR"},{id:"M31",name:"Andromeda Galaxy",ra:10.685,dec:41.269,magnitude:3.4,type:"Galaxy"},{id:"M42",name:"Orion Nebula",ra:83.82,dec:-5.391,magnitude:4,type:"Nebula"},{id:"M45",name:"Pleiades",ra:56.871,dec:24.105,magnitude:1.6,type:"Cluster"}].map(e=>({id:e.id,name:e.name,coordinates:{ra:e.ra,dec:e.dec},ra:e.ra,dec:e.dec,magnitude:e.magnitude,colorIndex:0,spectralClass:e.type,spectralType:e.type,properMotion:{ra:0,dec:0},constellation:this.getConstellation(e.ra,e.dec),metadata:{messier:!0,type:e.type}}))}passesFilters(e,t){var a;if(t.maxMagnitude&&e.magnitude>t.maxMagnitude)return!1;let r=null!=(a=e.dec)?a:e.coordinates.dec;return(!t.minDeclination||!(r<t.minDeclination))&&(!t.maxDeclination||!(r>t.maxDeclination))&&(!t.constellations||!e.constellation||!!t.constellations.includes(e.constellation))}gaussianRandom(){let e=0,t=0;for(;0===e;)e=Math.random();for(;0===t;)t=Math.random();return Math.sqrt(-2*Math.log(e))*Math.cos(2*Math.PI*t)}static getStarColor(e){if(!e)return{r:1,g:1,b:1};let t=e[0].toUpperCase();return this.SPECTRAL_COLORS[t]||{r:1,g:1,b:1}}clearCache(){this.catalogCache.clear(),this.loadingPromises.clear()}constructor(){this.catalogCache=new Map,this.loadingPromises=new Map}}u.CATALOG_URLS={hipparcos:"/data/catalogs/hipparcos_bright.json",yale:"/data/catalogs/yale_bright_star.json",gaia:"/data/catalogs/gaia_dr3_bright.json",messier:"/data/catalogs/messier.json",constellations:"/data/catalogs/constellation_lines.json"},u.SPECTRAL_COLORS={O:{r:.59,g:.67,b:1,temp:3e4},B:{r:.67,g:.78,b:1,temp:2e4},A:{r:.83,g:.87,b:1,temp:8500},F:{r:.96,g:.94,b:1,temp:6500},G:{r:1,g:.95,b:.81,temp:5500},K:{r:1,g:.85,b:.63,temp:4500},M:{r:1,g:.73,b:.54,temp:3e3}};class d{eclipticToZodiac(e){let t=[s.ARIES,s.TAURUS,s.GEMINI,s.CANCER,s.LEO,s.VIRGO,s.LIBRA,s.SCORPIO,s.SAGITTARIUS,s.CAPRICORN,s.AQUARIUS,s.PISCES],a=(e%360+360)%360;return{sign:t[Math.floor(a/30)],degree:a%30}}async initialize(e){this.config={...this.config,...e},await this.swissEphemeris.initialize()||console.warn("⚠️ Swiss Ephemeris bridge failed to initialize, falling back to placeholder calculations"),console.log("\uD83C\uDF1F Production Astronomical Engine initialized with Swiss Ephemeris")}setObserverLocation(e){this.observerLocation=e}async loadStarCatalog(e){try{console.log("\uD83D\uDCE1 Loading ".concat(e," star catalog..."));let t=(await this.starCatalogLoader.loadCatalog(e,{maxMagnitude:6.5,minDeclination:-90,maxDeclination:90})).map(e=>{var t,a;return{id:e.id,name:e.name,coordinates:{ra:null!=(t=e.ra)?t:0,dec:null!=(a=e.dec)?a:0},magnitude:e.magnitude,colorIndex:e.colorIndex||0,spectralClass:e.spectralType||"G2V",properMotion:e.properMotion||{ra:0,dec:0},parallax:e.distance?1e3/e.distance:void 0,constellation:e.constellation||"UNK"}});return console.log("✨ Loaded ".concat(t.length," stars from ").concat(e," catalog")),t}catch(t){return console.error("Failed to load ".concat(e," catalog:"),t),[]}}async getVisibleStars(){return[]}transformCoordinates(){return{x:0,y:0,visible:!1}}equatorialToHorizontal(){return{azimuth:0,altitude:0}}async getPlanetaryPositions(e,t){try{let a=(await this.swissEphemeris.calculatePlanetaryPositions({planets:["sun","moon","mercury","venus","mars","jupiter","saturn","uranus","neptune","pluto"],datetime:e,location:{...t,lat:t.latitude,lon:t.longitude,altitude:t.elevation},options:{includeRetrograde:!0,calculateAspects:!1,includeHouses:!1,heliocentric:!1}})).map(e=>{var t,a,r,i,n,o,s,l,c,u;let d=this.eclipticToZodiac(e.eclipticLongitude);return{planet:e.name,coordinates:{ra:null!=(o=null!=(n=null==(t=e.position)?void 0:t.ra)?n:null==(a=e.coordinates)?void 0:a.ra)?o:0,dec:null!=(l=null!=(s=null==(r=e.position)?void 0:r.dec)?s:null==(i=e.coordinates)?void 0:i.dec)?l:0},horizontalCoords:{azimuth:0,altitude:0},eclipticLongitude:e.eclipticLongitude,eclipticLatitude:e.eclipticLatitude,distance:e.distance,angularDiameter:null!=(u=null!=(c=e.angularSize)?c:e.angularDiameter)?u:0,magnitude:e.magnitude,phase:e.phase,retrograde:e.retrograde,sign:d.sign,degree:d.degree}});return console.log("\uD83E\uDE90 Calculated ".concat(a.length," planetary positions for ").concat(e.toISOString())),a}catch(e){return console.error("Error calculating planetary positions:",e),[]}}async getPlanetPosition(e,t,a){let r=(await this.getPlanetaryPositions(t,a)).find(t=>t.planet===e);if(!r)throw Error("Planet position not found: ".concat(e));return r}calculateAspects(){return[]}async detectRetrogrades(e,t){return[]}calculateHouses(e,t,a){return Array(12).fill(0)}async getMoonPhase(e){throw Error("Not implemented - awaiting Claude Opus 4 algorithms")}async getMoonPosition(e,t){throw Error("Not implemented - awaiting Claude Opus 4 algorithms")}calculatePrecession(e,t){return{deltaRA:0,deltaDec:0}}calculatePrecessionMatrix(e,t,a){let r=Math.cos(e),i=Math.sin(e),n=Math.cos(t),o=Math.sin(t),s=Math.cos(a),l=Math.sin(a);return[[r*n*s-i*o,-i*n*s-r*o,-o*s],[r*o*s+i*n,-i*o*s+r*n,n*s],[r*l,-i*l,s]]}calculateLimitingMagnitude(e){return Math.min(6.5+(e.elevation||0)/1e3*.1,7)}isMilkyWayVisible(e){return this.calculateLimitingMagnitude(e)>5}calculateVisualBrightness(e){return e<=0?0:Math.max(0,Math.min(1,Math.exp(-.2*(1/Math.sin(e*Math.PI/180)-1))))}async getVisibleSky(e,t){throw Error("Not implemented - awaiting Claude Opus 4 algorithms")}async calculateCosmicWeather(e){throw Error("Not implemented - awaiting Claude Opus 4 algorithms")}getPlanetaryHour(e,t){return o.SUN}dateToJulianDay(e){let t=Math.floor((14-(e.getMonth()+1))/12),a=e.getFullYear()+4800-t,r=e.getMonth()+1+12*t-3;return e.getDate()+Math.floor((153*r+2)/5)+365*a+Math.floor(a/4)-Math.floor(a/100)+Math.floor(a/400)-32045}julianDayToDate(e){let t=e+32044,a=Math.floor((4*t+3)/146097),r=t-Math.floor(146097*a/4),i=Math.floor((4*r+3)/1461),n=r-Math.floor(1461*i/4),o=Math.floor((5*n+2)/153),s=n-Math.floor((153*o+2)/5)+1,l=o+3-12*Math.floor(o/10);return new Date(100*a+i-4800+Math.floor(o/10),l-1,s)}getSiderealTime(e,t){return 0}async preloadEphemerisData(e,t){console.log("\uD83D\uDCCA Preloading ephemeris data from ".concat(e.toISOString()," to ").concat(t.toISOString()))}clearCache(){console.log("\uD83D\uDDD1️ Clearing astronomical calculation cache")}constructor(){this.observerLocation={latitude:40.7128,longitude:-74.006,elevation:10,timezone:"America/New_York"},this.config={ephemerisAccuracy:"medium",updateInterval:1e3,precessionCorrection:!0,nutationCorrection:!0,aberrationCorrection:!0,refractionCorrection:!0},this.swissEphemeris=new c({precision:"high",timeout:3e4}),this.starCatalogLoader=new u}}let h=new d,g=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{enableHighAccuracy:t=!0,timeout:a=1e4,maximumAge:r=3e5,fallbackLocation:n={latitude:40.7128,longitude:-74.006,elevation:10,timezone:"America/New_York"}}=e,o=(0,i.useMemo)(()=>n,[n]),s=(0,i.useRef)(!1),[l,c]=(0,i.useState)({location:null,loading:!1,error:null,permission:"unknown"}),u=async(e,t)=>{try{let e=Intl.DateTimeFormat().resolvedOptions().timeZone;if(e)return e;let a=Math.round(t/15);if(a>=-12&&a<=12)return"UTC".concat(a>=0?"+":"").concat(a);return"UTC"}catch(e){return"UTC"}},d=()=>0,h=(0,i.useCallback)(async()=>{if(!s.current){if(!navigator.geolocation)return void c(e=>({...e,error:"Geolocation is not supported by this browser",permission:"denied",location:o}));s.current=!0,c(e=>({...e,loading:!0,error:null}));try{if("permissions"in navigator){let e=await navigator.permissions.query({name:"geolocation"});if(c(t=>({...t,permission:e.state})),"denied"===e.state){c(e=>({...e,loading:!1,error:"Geolocation permission denied",location:o})),s.current=!1;return}}navigator.geolocation.getCurrentPosition(async e=>{let{latitude:t,longitude:a,altitude:r}=e.coords;try{let e=await u(t,a),i=r||d(),n={latitude:t,longitude:a,elevation:i,timezone:e};c(e=>({...e,location:n,loading:!1,error:null,permission:"granted"})),s.current=!1}catch(i){let e={latitude:t,longitude:a,elevation:r||0,timezone:o.timezone};c(t=>({...t,location:e,loading:!1,error:null,permission:"granted"})),s.current=!1}},e=>{let t="Failed to get location";switch(e.code){case e.PERMISSION_DENIED:t="Location access denied by user";break;case e.POSITION_UNAVAILABLE:t="Location information unavailable";break;case e.TIMEOUT:t="Location request timed out"}c(a=>({...a,loading:!1,error:t,permission:e.code===e.PERMISSION_DENIED?"denied":a.permission,location:o})),s.current=!1},{enableHighAccuracy:t,timeout:a,maximumAge:r})}catch(e){c(t=>({...t,loading:!1,error:e instanceof Error?e.message:"Unknown error",location:o})),s.current=!1}}},[t,r,a,o]);return(0,i.useEffect)(()=>{h()},[h]),{...l,requestLocation:h,watchLocation:()=>navigator.geolocation?navigator.geolocation.watchPosition(async e=>{let{latitude:t,longitude:a,altitude:r}=e.coords,i=await u(t,a),n={latitude:t,longitude:a,elevation:r||d(),timezone:i};c(e=>({...e,location:n,error:null}))},e=>{console.warn("Geolocation watch error:",e)},{enableHighAccuracy:t,timeout:a,maximumAge:r}):null,clearLocation:()=>{c(e=>({...e,location:null,error:null}))},useFallback:()=>{c(e=>({...e,location:o,error:null,loading:!1}))},hasLocation:!!l.location,isLocationAccurate:"granted"===l.permission&&!!l.location}};var p=a(9040),m=a(4493),f=a.n(m);let S=e=>{let{useRealStars:t=!1,renderConfig:a={},className:o="",onStarClick:s,onPerformanceUpdate:l}=e,c=(0,i.useRef)(null),u=(0,i.useRef)(null),d=(0,i.useRef)(0),m=(0,i.useRef)(l);(0,i.useEffect)(()=>{m.current=l},[l]);let[S,M]=(0,i.useState)(!1),[C,w]=(0,i.useState)(null),[y,I]=(0,i.useState)(0),{location:A,loading:b}=g(),_=(0,i.useCallback)(e=>{var t,a,r,i,n,o,s,l;return{...e,ra:null!=(t=e.ra)?t:e.coordinates.ra,dec:null!=(a=e.dec)?a:e.coordinates.dec,colorIndex:null!=(r=e.colorIndex)?r:0,spectralClass:null!=(i=e.spectralClass)?i:"Unknown",spectralType:null!=(o=null!=(n=e.spectralType)?n:e.spectralClass)?o:"Unknown",constellation:null!=(s=e.constellation)?s:"Unknown",properMotion:null!=(l=e.properMotion)?l:{ra:0,dec:0}}},[]),P=(0,i.useMemo)(()=>({starCatalog:"hipparcos",maxStars:1e5,minMagnitude:6.5,showConstellations:!1,showPlanets:!0,showDeepSky:!1,coordinateSystem:"horizontal",projection:"stereographic",...a}),[a]),E=(0,i.useCallback)(()=>{let e=t=>{if(u.current){let e=u.current.render(t);m.current&&m.current({totalStars:e.totalStars,visibleStars:e.visibleStars,fps:e.fps,renderTime:e.renderTime})}d.current=requestAnimationFrame(e)};d.current=requestAnimationFrame(e)},[]),v=(0,i.useCallback)(async()=>{if(!c.current)return void console.log("❌ Canvas ref not available");try{M(!0),w(null),console.log("\uD83D\uDE80 Initializing high-performance star renderer...");let e=c.current,a=e.getBoundingClientRect();console.log("\uD83D\uDCD0 Canvas size: ".concat(a.width,"x").concat(a.height));let r=new n(e);u.current=r,r.resize(a.width,a.height),console.log("\uD83D\uDCD0 Renderer resized to: ".concat(a.width,"x").concat(a.height));let i=[];t&&A?(console.log("\uD83C\uDF1F Loading real astronomical star data..."),await h.initialize({ephemerisAccuracy:"high",updateInterval:1e3,precessionCorrection:!0,nutationCorrection:!0,aberrationCorrection:!0,refractionCorrection:!0}),i=(await h.loadStarCatalog(P.starCatalog)).filter(e=>e.magnitude<=P.minMagnitude).slice(0,P.maxStars).sort((e,t)=>e.magnitude-t.magnitude).map(_),console.log("✨ Loaded ".concat(i.length," real stars from ").concat(P.starCatalog," catalog"))):(console.log("\uD83C\uDFA8 Generating ".concat(P.maxStars," procedural stars...")),i=D(P.maxStars),console.log("✅ Generated ".concat(i.length," procedural stars for testing")),console.log("Sample star:",i[0])),console.log("\uD83D\uDCE4 Loading ".concat(i.length," stars into renderer...")),r.loadStars(i),I(i.length),console.log("✅ Stars loaded into renderer");let o=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),s=a.width/a.height,l=x(Math.PI/2,s,.1,10);console.log("\uD83D\uDCF7 Camera setup: FOV=90\xb0, aspect=".concat(s.toFixed(2),", near=0.1, far=10.0")),r.updateMatrices(o,l),console.log("\uD83C\uDFAC Starting render loop..."),E(),console.log("✅ Render loop started")}catch(e){console.error("Failed to initialize high-performance star renderer:",e),w(e instanceof Error?e.message:"Unknown error")}finally{M(!1)}},[t,A,P,_,E]),D=e=>{let t=[];for(let a=0;a<e;a++){let e=360*Math.random(),r=(Math.random()-.5)*180,i=1+5*Math.pow(Math.random(),.3),n=(Math.random()-.5)*2,o={id:"proc_".concat(a),name:"Star ".concat(a),coordinates:{ra:e,dec:r},ra:e,dec:r,magnitude:i,colorIndex:n,spectralClass:"G2V",spectralType:"G2V",properMotion:{ra:0,dec:0},constellation:"Generated"};t.push(o)}return t},x=(e,t,a,r)=>{let i=1/Math.tan(e/2),n=1/(a-r);return new Float32Array([i/t,0,0,0,0,i,0,0,0,0,(a+r)*n,-1,0,0,a*r*n*2,0])},R=(0,i.useCallback)(()=>{if(c.current&&u.current){let e=c.current.getBoundingClientRect();u.current.resize(e.width,e.height)}},[]);(0,i.useEffect)(()=>(b||v(),()=>{d.current&&cancelAnimationFrame(d.current),u.current&&u.current.dispose()}),[v,b]),(0,i.useEffect)(()=>(window.addEventListener("resize",R),()=>window.removeEventListener("resize",R)),[R]);let T=(0,i.useCallback)(e=>{var t;if(!s||!u.current)return;let a=null==(t=c.current)?void 0:t.getBoundingClientRect();if(!a)return;let r=e.clientX-a.left,i=e.clientY-a.top;console.log("Star click at (".concat(r,", ").concat(i,")"))},[s]);return(0,r.jsxs)("div",{className:"".concat(f().starFieldContainer," ").concat(o),children:[(0,r.jsx)(p.L,{intensity:.8,showMilkyWay:!0,animated:!0,className:f().galaxyBackground}),(0,r.jsx)("canvas",{ref:c,className:f().starCanvas,onClick:T}),S&&(0,r.jsxs)("div",{className:f().loadingOverlay,children:[(0,r.jsx)("div",{className:f().loadingSpinner}),(0,r.jsxs)("p",{children:["Loading ",t?"real astronomical":"procedural"," star data..."]})]}),C&&(0,r.jsx)("div",{className:f().errorOverlay,children:(0,r.jsxs)("div",{className:f().errorMessage,children:[(0,r.jsx)("h3",{children:"⚠️ Rendering Error"}),(0,r.jsx)("p",{children:C}),(0,r.jsx)("button",{onClick:()=>w(null),children:"Retry"})]})}),!S&&!C&&(0,r.jsxs)("div",{className:f().performanceInfo,children:[(0,r.jsxs)("span",{className:f().starCount,children:["⭐ ",y.toLocaleString()," stars"]}),(0,r.jsx)("span",{className:f().mode,children:t?"\uD83D\uDD2C Real Data":"\uD83C\uDFA8 Procedural"})]})]})}},9040:(e,t,a)=>{"use strict";a.d(t,{L:()=>s});var r=a(5155),i=a(2115),n=a(334),o=a.n(n);let s=e=>{let{className:t="",intensity:a=.7,showMilkyWay:n=!0,animated:s=!0,starCount:l}=e,c=(0,i.useRef)(null);return(0,i.useEffect)(()=>{let e,t=c.current;if(!t)return;let r=t.getContext("2d");if(!r)return;let i=()=>{let e=t.getBoundingClientRect(),i=e.width,o=e.height;r.clearRect(0,0,i,o);let s=l||Math.min(75,Math.floor(i*o/16e3));for(let e=0;e<s;e++){let e,t=Math.random()*i,n=Math.random()*o,s=1.5*Math.random(),l=Math.random()*a*.4,c=Math.random();r.fillStyle=e=c<.1?"rgba(155, 176, 255, ".concat(l,")"):c<.3?"rgba(202, 215, 255, ".concat(l,")"):c<.6?"rgba(255, 244, 234, ".concat(l,")"):c<.8?"rgba(255, 210, 161, ".concat(l,")"):"rgba(255, 204, 111, ".concat(l,")"),r.beginPath(),r.arc(t,n,s,0,2*Math.PI),r.fill(),l>.15&&(r.shadowColor=e,r.shadowBlur=+s,r.beginPath(),r.arc(t,n,.3*s,0,2*Math.PI),r.fill(),r.shadowBlur=0)}if(n){let e=r.createLinearGradient(0,.3*o,i,.7*o);e.addColorStop(0,"rgba(139, 69, 19, ".concat(.1*a,")")),e.addColorStop(.3,"rgba(160, 82, 45, ".concat(.15*a,")")),e.addColorStop(.5,"rgba(205, 133, 63, ".concat(.2*a,")")),e.addColorStop(.7,"rgba(160, 82, 45, ".concat(.15*a,")")),e.addColorStop(1,"rgba(139, 69, 19, ".concat(.1*a,")")),r.fillStyle=e,r.fillRect(0,.3*o,i,.4*o);for(let e=0;e<3;e++){let e=Math.random()*i,t=.4*o+Math.random()*o*.2,n=50+100*Math.random(),s=r.createRadialGradient(e,t,0,e,t,n),l=["rgba(255, 20, 147, ".concat(.1*a,")"),"rgba(138, 43, 226, ".concat(.08*a,")"),"rgba(75, 0, 130, ".concat(.05*a,")")],c=l[Math.floor(Math.random()*l.length)];s.addColorStop(0,c),s.addColorStop(1,"rgba(0, 0, 0, 0)"),r.fillStyle=s,r.fillRect(e-n,t-n,2*n,2*n)}}},o=()=>{let e=t.getBoundingClientRect(),a=window.devicePixelRatio||1;t.width=e.width*a,t.height=e.height*a,t.style.width="".concat(e.width,"px"),t.style.height="".concat(e.height,"px"),r.scale(a,a),i()};o(),window.addEventListener("resize",o);let u=0;if(s){let t=a=>{a-u>5e3&&(i(),u=a),e=requestAnimationFrame(t)};e=requestAnimationFrame(t)}return()=>{window.removeEventListener("resize",o),e&&cancelAnimationFrame(e)}},[a,n,s,l]),(0,r.jsxs)("div",{className:"".concat(o().galaxyContainer," ").concat(t),children:[(0,r.jsx)("div",{className:o().galaxyGradient,style:{opacity:a,background:n?"radial-gradient(ellipse at center, \n                rgba(25, 25, 112, 0.8) 0%, \n                rgba(72, 61, 139, 0.6) 30%, \n                rgba(123, 104, 238, 0.4) 50%, \n                rgba(25, 25, 112, 0.3) 70%, \n                rgba(0, 0, 0, 0.9) 100%),\n               linear-gradient(45deg, \n                rgba(138, 43, 226, 0.1) 0%, \n                rgba(75, 0, 130, 0.2) 50%, \n                rgba(25, 25, 112, 0.1) 100%)":"radial-gradient(ellipse at center, \n                rgba(25, 25, 112, 0.6) 0%, \n                rgba(0, 0, 0, 0.8) 70%, \n                rgba(0, 0, 0, 1) 100%)"}}),(0,r.jsx)("canvas",{ref:c,className:o().galaxyCanvas}),s&&(0,r.jsx)("div",{className:o().cosmicDust,style:{opacity:.3*a}})]})}}}]);